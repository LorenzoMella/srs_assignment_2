---
title: "Statistical Research Skills -- Assignment 2"
author: "Lorenzo Mella (UUN: s1566023)"
output: pdf_document
---


# Description of the problem

Kernel density estimation (KDE) models the distribution under a criterion of smoothness of the density. Under the heuristic principle that datapoints in a sample generated form a distribution with density $f(x)$ tautologically accumulate with high probability in high-density regions, we associate to each datapoint $x_i$ a scaled kernel $K_h(x-x_i)$. The average of these functions hopefully provides a good approximation to the original density.

The choice of kernel is dictated by numerical requirements: if the kernel has unbounded support, for instance, every summand must be computed in $x$, to evaluate the density $\hat{f}(x)$.

It is also dictated by smoothness considerations: if we expect the data to be generate from a smooth density, it would be more sensible to use graded kernels such as a Gaussian or the Epanechnikov kernel. A rectangular kernel would be more appropriate for piecewise constant densities.


## Kernel density estimator

Problematic choices:

- bandwidth
- kernel shape

```{r}

```

## Histogram estimator

Problematic choices:

- number of bins

## Mixture model estimator

Problematic parameter:

- conditional distributions
- number of conditional distributions


# Experimental setting

## Densities that represent a wide testing range of possibilities

```{r}
# Densities to be tested

# Normal (unimodal base case)
density_1 = function(x) dnorm(x, 0, 3)
# Student t (unimodal with heavier tails)
density_2 = function(x) dt(x / 3, df = 1)
# Uniform (discontinuous density with a dense modes)
density_3 = function(x) dunif(x, 0, 3)
# Gamma (unimodal, positively skewed)
density_4 = function(x) dgamma(x, 3, 1)
# Mixture of distributions (trimodal, with many of the challenging features of the previous ones)
density_5 = function(x) {
  0.5 * dnorm(x, 0, 1) + 0.3 * dgamma(8 - x, 2, 1.5) + 0.2 * dunif(x, 3, 4.5)
}
# Random-number generator for density_5
rdensity_5 = function(n) {
  num_samples = rmultinom(1, n, c(0.5, 0.3, 0.2))
  sample(c(rnorm(num_samples[1], 0, 1), 8 - rgamma(num_samples[2], 2, 1.5), runif(num_samples[3], 3, 4.5)))
}


```

## One shot experiments

- Graphs
- Discussion

```{r}
max_samples = 250
# Generate data from the first density
normalmixEM()



plot.mixEM()
```


## Monte Carlo simulation

- ISEs for sample sizes 250, 500, 1000
- Discussion
